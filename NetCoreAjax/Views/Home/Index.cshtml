@{
    ViewData["Title"] = "Home Page";
}

<div class="text-center">
    <h1 class="display-4">Bienvenidos</h1>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="p-2">
          
            @Html.TextBox("UserId","", new { @class = "form-control", @placeholder = "busqueda por Id" })
            <button type="button" id="btnBuscar" class="btn btn-block btn-info"> buscar </button>
        </div>
        <div class="p-2" id="busqueda">

        </div>
    </div>
    <div class="col-md-6">
        <div class="p-2">
            <button type="button" id="btnMostrar" class="btn btn-block btn-info">Actualizar Lista</button>
        </div>
        <div class="p-2" id="lista">
            <div id="loader" class="d-flex align-items-center" style="display:none!important">
                <strong>Cargando...</strong>
                <div class="spinner-border ms-auto" role="status" aria-hidden="true"></div>
            </div>
        </div>
    </div>
    <div class="col-md-12">
        @Html.TextBox("frmUserId", "", new { @class = "form-control", @placeholder = "Id" })
        @Html.TextBox("frmUserName", "", new { @class = "form-control", @placeholder = "Nombre" })
        <button type="button" id="userAdd" class="btn btn-block btn-info">Agregar elemento</button>
    </div>
</div>

@section JavaScript{
    <script>
        $(document).ready(function () {
            $("#btnBuscar").click(I => {
                let id = $("#UserId").val();
                
                $.ajax({
                    contentType: "application/json; charset=Utf-8;",
                    dataType: "json",
                    type: "Get",
                    url: "/Home/GetById",
                    data: { UserId: id },
                    success: function (data) {
                        let convert = jQuery.parseJSON(data);
                        let htmlString = `<table class:"table table-hover table-sm"> <tr> <th>Id </th> <td>${convert.Id} </td> </tr> <tr> <th>Nombre </th> <td>${convert.Name} </td> </tr> </table>`;

                        $("#busqueda").html(htmlString);
                    }
                })
            })

            $("#btnMostrar").click(function () {
                $.ajax({
                    type: "Get",
                    dataType: "json",
                    contentType: "application/json; charset=Utf-8;",
                    url: "/Home/List",
                    beforeSend: function () {
                        $("#loader").show();
                    },
                    success: function (data) {
                        $("#loader").hide();
                        let users = jQuery.parseJSON(data);
                        let htmlString = "<table class='EstiloBAMSA'> <tr> <th>Id </th> <th>Nombre</th> </tr> "

                        $.each(users, (index, value) => {
                            htmlString += `<tr> <td> ${value.Id} </td> <td> ${value.Name}</td> </tr>`;
                        });
                        htmlString += "</table>";

                        $("#lista").html(htmlString);
                    }

                });
            });

            $("#userAdd").click(function () {
                let user = {
                    Name: $("#frmUserName").val(),
                    Id: $("#frmUserId").val()
                };
                $.ajax({
                    type: "Post",
                    url: "/Home/Add",
                    data: user,
                    success: function (gelenCevap) {
                        let gelenObje = jQuery.parseJSON(gelenCevap);
                    }
                });
                
            });
        });
    </script>
}


    <style>
        .EstiloBAMSA {
            border-color: #E6E6E6;
            border-width: 1px;
            border-style: solid;
        }
    </style>
